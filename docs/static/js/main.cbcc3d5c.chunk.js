(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{110:function(e,t,r){"use strict";r.r(t);var a,n=r(0),o=r.n(n),c=r(8),l=r.n(c),u=(r(92),r(149)),i=r(153),s=r(154),p=function(){return o.a.createElement("header",null,o.a.createElement(u.a,{position:"static"},o.a.createElement(i.a,null,o.a.createElement(s.a,{variant:"h6"},"Spendesk Team view"))))},d=r(33),m=r(155),v=r(111),f=r(157),h=r(161),b=r(160),E=r(156),O=r(158),g=r(169),j=r(159),S=Object(m.a)({root:{width:"100%"},container:{maxHeight:440}}),I=function(e){var t=e.columns,r=e.rows,a=S(),n=o.a.useState(0),c=Object(d.a)(n,2),l=c[0],u=c[1],i=o.a.useState(10),s=Object(d.a)(i,2),p=s[0],m=s[1];return o.a.createElement(v.a,{className:a.root},o.a.createElement(E.a,{className:a.container},o.a.createElement(f.a,{stickyHeader:!0,"aria-label":"sticky table"},o.a.createElement(O.a,null,o.a.createElement(j.a,null,t.map((function(e){return o.a.createElement(b.a,{key:e.id,align:e.align,style:{minWidth:e.minWidth}},e.label)})))),o.a.createElement(h.a,null,r.slice(l*p,l*p+p).map((function(e){return o.a.createElement(j.a,{hover:!0,role:"checkbox",tabIndex:-1,key:e.id},t.map((function(t){var r=e[t.id];return o.a.createElement(b.a,{key:t.id,align:t.align},t.format&&"number"===typeof r?t.format(r):r)})))}))))),o.a.createElement(g.a,{rowsPerPageOptions:[5,10],component:"div",count:r.length,rowsPerPage:p,page:l,onChangePage:function(e,t){u(t)},onChangeRowsPerPage:function(e){m(+e.target.value),u(0)}}))},y=r(30),w=r(17),N=r(16),A=r(24),T=r(57),k=r.n(T),U=r(73),x=r(74),F=r.n(x),C=function(){var e=Object(U.a)(k.a.mark((function e(t){var r,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("HTTP error! status: ".concat(r.status));case 5:return e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",F()(a));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();!function(e){e[e.Idle=0]="Idle",e[e.Loading=1]="Loading",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed"}(a||(a={}));var P={status:a.Idle,error:null},W=function(e){return function(t){return function(r){r.addCase(e.fulfilled,(function(e,r){var n=r.payload;e.status=a.Succeeded,e.error=null,t.setAll(e,n)})),r.addCase(e.pending,(function(e,t){t.payload;e.status=a.Loading})),r.addCase(e.rejected,(function(e,t){var r=t.payload;e.status=a.Failed,e.error=r}))}}},B=Object(N.c)(),D=Object(N.b)("teams",(function(){return C("https://s3-eu-west-1.amazonaws.com/spx-development/contents/teams")})),L=B.getInitialState(P),q=Object(N.d)({name:"teams",initialState:L,reducers:{},extraReducers:W(D)(B)}),H=function(e){return e.teams},M=Object(A.a)(H,(function(e){return e.status})),R=(Object(A.a)(H,(function(e){return e.error})),B.getSelectors(H)),z=R.selectAll,J=R.selectById,V=q.reducer;function $(e){var t=e.loadingStates,r=e.children,n=t.some((function(e){return e===a.Failed})),c=t.some((function(e){return e===a.Loading}));return o.a.createElement("section",null,n&&o.a.createElement("h3",null,"An error occured loading some ressources"),c&&o.a.createElement("h3",null,"Currently loading..."),!c&&!n&&o.a.createElement(o.a.Fragment,null,r))}var G,K,Q=[{id:"teamName",label:"Team name",minWidth:170},{id:"teamMembersCount",label:"Number of people",minWidth:100}],X=function(e){return{id:e.id,teamName:o.a.createElement(y.b,{to:"/team/".concat(e.id)},e.name),teamMembersCount:e.users.length}},Y=function(){var e=Object(w.b)(),t=Object(w.c)(z),r=Object(w.c)(M);Object(n.useEffect)((function(){r===a.Idle&&e(D())}),[r,e]);var c=t.map(X);return o.a.createElement($,{loadingStates:[r]},o.a.createElement(I,{columns:Q,rows:c}))},Z=Object(N.c)(),_=Object(N.b)("users",(function(){return C("https://s3-eu-west-1.amazonaws.com/spx-development/contents/users")})),ee=Z.getInitialState(P),te=Object(N.d)({name:"users",initialState:ee,reducers:{},extraReducers:W(_)(Z)}),re=function(e){return e.users},ae=Object(A.a)(re,(function(e){return e.status})),ne=(Object(A.a)(re,(function(e){return e.error})),Z.getSelectors(re)),oe=ne.selectAll,ce=(ne.selectById,ne.selectEntities),le=te.reducer,ue=Object(N.c)({selectId:function(e){return e.teamId}}),ie=ue.getInitialState(),se=Object(N.d)({name:"approvalScheme",initialState:ie,reducers:{setApprovalScheme:function(e,t){var r=t.payload;ue.removeOne(e,r.teamId),ue.addOne(e,r)}}}),pe=se.actions.setApprovalScheme,de=ue.getSelectors((function(e){return e.approvalScheme})),me=(de.selectAll,de.selectById),ve=se.reducer,fe=r(40),he=r(62),be=r(39),Ee=r(167),Oe=r(168);!function(e){e.ApproverNotUnique="ApproverNotUnique",e.ApproverUndefined="ApproverUndefined",e.ThresholdNotPositiveNumber="ThresholdNotPositiveNumber",e.ThresholdOverlapping="ThresholdOverlapping"}(K||(K={}));var ge=(G={},Object(be.a)(G,K.ApproverNotUnique,(function(e){var t=e.approvalSteps,r=Object(Ee.a)((function(e){return e.approverUserId}),t);return t.length===r.length})),Object(be.a)(G,K.ApproverUndefined,(function(e){return!e.approvalSteps.some((function(e){return null===e.approverUserId}))})),Object(be.a)(G,K.ThresholdNotPositiveNumber,(function(e){return!e.approvalSteps.some((function(e){return null!==e.threshold&&("number"!==typeof e.threshold||e.threshold<=0)}))})),Object(be.a)(G,K.ThresholdOverlapping,(function(e){var t=e.approvalSteps,r=t.length-1;return null===t[r].threshold&&function(){if(t.length<3)return!0;for(var e=r-1;e>0;e--){var a=t[e].threshold,n=t[e-1].threshold;return null!==a&&null!==n&&!(a<=n)}return!0}()})),G),je=r(13),Se=r(165),Ie=r(171),ye=r(172),we=r(170),Ne=r(164),Ae=r(166),Te=[{id:"approverName",label:"Approver name",minWidth:170},{id:"approveFrom",label:"Approve From",minWidth:200},{id:"approveTo",label:"Approve To",minWidth:200}];function ke(e){var t=Object(w.b)(),r=Object(n.useState)(e),a=Object(d.a)(r,2),o=a[0],c=a[1],l=Object(n.useState)([]),u=Object(d.a)(l,2),i=u[0],s=u[1];return{draft:o,draftErrors:i,draftActions:{addStepToDraft:function(){return c(function(e){var t=e.approvalSteps,r=t.length,a=t.length-1,n=null,o=0===r?[{approverUserId:n,threshold:null}]:1===r?[{approverUserId:n,threshold:0}].concat(Object(he.a)(t)):[].concat(Object(he.a)(Object(Oe.a)(r-1,t)),[{approverUserId:n,threshold:t[a-1].threshold},t[a]]);return Object(fe.a)(Object(fe.a)({},e),{},{approvalSteps:o})}(o))},modifyThreshold:function(e,t){return c(function(e){return function(t){return function(r){var a=r.approvalSteps,n=a.length-1;return t>=n?r:(a[t].threshold=e,Object(fe.a)(Object(fe.a)({},r),{},{approvalSteps:a}))}}}(e)(t)(o))},modifyApprover:function(e,t){return c(function(e){return function(t){return function(r){var a=r.approvalSteps,n=a.length-1;return t>n?r:(a[t].approverUserId=e,Object(fe.a)(Object(fe.a)({},r),{},{approvalSteps:a}))}}}(e)(t)(o))},validateDraft:function(){var e=function(e){return Object.entries(ge).reduce((function(t,r){var a=Object(d.a)(r,2),n=a[0];return(0,a[1])(e)||t.push(n),t}),[])}(o);0===e.length&&t(pe(o)),s(e)}}}}var Ue=function(e){return function(t){return function(r){var a=Object(N.e)();return o.a.createElement(Ne.a,null,o.a.createElement(ye.a,{id:a},"Users"),o.a.createElement(Ae.a,{value:null!==r&&void 0!==r?r:"",labelId:a,id:a,onChange:t},e.map((function(e){return o.a.createElement(we.a,{value:e.id,key:e.id},"".concat(e.firstName," ").concat(e.lastName))}))))}}};function xe(){var e=Object(w.b)(),t=Object(je.g)().teamId,r=Object(w.c)((function(e){return J(e,t)})),c=Object(w.c)(M),l=Object(w.c)(ce),u=Object(w.c)(oe),i=Object(w.c)(ae),s=Object(w.c)((function(e){return me(e,t)})),p=null!==s&&void 0!==s?s:function(e){return{teamId:e,approvalSteps:[]}}(t);Object(n.useEffect)((function(){c===a.Idle&&e(D())}),[c,e]),Object(n.useEffect)((function(){i===a.Idle&&e(_())}),[i,e]);var d,m=ke(p),v=m.draft,f=m.draftErrors,h=m.draftActions,b=(d=l,function(e){return e.reduce((function(e,t,r,a){var n=t.approverUserId?d[t.approverUserId]:void 0,o=void 0===n?"":"".concat(n.firstName," ").concat(n.lastName),c=0===r?{id:r,approverId:t.approverUserId,approverName:o,approveFrom:0,approveTo:t.threshold}:{id:r,approverId:t.approverUserId,approverName:o,approveFrom:a[r-1].threshold,approveTo:t.threshold};return e.push(c),e}),[])})(v.approvalSteps).map(function(e){return function(t){return function(r){return{id:r.id.toString(),approverName:Ue(e)((function(e){return t.modifyApprover(e.target.value,r.id)}))(r.approverId),approveFrom:"From: "+r.approveFrom,approveTo:null===r.approveTo?" - ":o.a.createElement(o.a.Fragment,null,o.a.createElement(Ie.a,{id:"standard-number",label:"Up to",type:"number",value:r.approveTo,onChange:function(e){return t.modifyThreshold(+e.target.value,r.id)}}))}}}}(u)(h));return void 0===r&&c===a.Succeeded?o.a.createElement("section",null,o.a.createElement("section",null,o.a.createElement(y.b,{to:"/"},"Back to teams list")),o.a.createElement("h5",null,"No team with this Id exist")):o.a.createElement($,{loadingStates:[c,i]},o.a.createElement("section",null,o.a.createElement("section",null,o.a.createElement(y.b,{to:"/"},"Back to teams list")),o.a.createElement("section",null,o.a.createElement("h5",null,void 0===s?"No approval scheme created yet":"Below the approval scheme defined"," for ".concat(null===r||void 0===r?void 0:r.name)),o.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:h.addStepToDraft},"Add approval step"),o.a.createElement(I,{rows:b,columns:Te}),o.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:h.validateDraft},"Validate the approval scheme"),f.length>0&&o.a.createElement("div",null,o.a.createElement("h5",null,"Approval Scheme invalid: "),f.map((function(e){return o.a.createElement("p",null,e)}))))))}var Fe=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(y.a,null,o.a.createElement(p,null),o.a.createElement(je.d,null,o.a.createElement(je.b,{exact:!0,path:"/"},o.a.createElement(Y,null)),o.a.createElement(je.b,{path:"/team/:teamId"},o.a.createElement(xe,null)),o.a.createElement(je.b,{path:"*"},o.a.createElement(je.a,{to:"/"})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ce=r(23),Pe=Object(Ce.c)({users:le,teams:V,approvalScheme:ve}),We=Object(N.a)({reducer:Pe});l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(w.a,{store:We},o.a.createElement(Fe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},87:function(e,t,r){e.exports=r(110)},92:function(e,t,r){}},[[87,1,2]]]);
//# sourceMappingURL=main.cbcc3d5c.chunk.js.map